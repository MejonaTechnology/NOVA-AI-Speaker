; NOVA AI Voice Assistant - ESP32-S3
; Use 'esp32s3' for USB upload, 'esp32s3-ota' for wireless OTA upload

[env:esp32s3]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200
upload_speed = 921600


; PSRAM and memory settings
board_build.arduino.memory_type = qio_opi
board_build.flash_mode = qio
board_build.f_flash = 80000000L
board_upload.flash_size = 16MB
board_build.partitions = huge_app.csv

; Edge Impulse wake word library
lib_extra_dirs = lib/ei-wake-word

build_flags =
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -DEI_CLASSIFIER_TFLITE_ENABLE_ESP_NN=0
    -w

lib_deps =
    adafruit/Adafruit NeoPixel @ ^1.11.0
    adafruit/Adafruit SSD1306 @ ^2.5.7
    adafruit/Adafruit GFX Library @ ^1.11.3

; ============== OTA Wireless Upload Environment ==============
[env:esp32s3-ota]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino
monitor_speed = 115200

; PSRAM and memory settings
board_build.arduino.memory_type = qio_opi
board_build.flash_mode = qio
board_build.f_flash = 80000000L
board_upload.flash_size = 16MB
board_build.partitions = huge_app.csv

; Edge Impulse wake word library
lib_extra_dirs = lib/ei-wake-word

build_flags =
    -DBOARD_HAS_PSRAM
    -mfix-esp32-psram-cache-issue
    -DEI_CLASSIFIER_TFLITE_ENABLE_ESP_NN=0
    -w
    ; OTA Performance optimization
    -DCONFIG_ARDUINO_UDP_RUN_CORE1=1
    -DCONFIG_ASYNC_TCP_RUNNING_CORE=1

lib_deps =
    adafruit/Adafruit NeoPixel @ ^1.11.0
    adafruit/Adafruit SSD1306 @ ^2.5.7
    adafruit/Adafruit GFX Library @ ^1.11.3

; OTA Upload Configuration
upload_protocol = espota
upload_port = 192.168.31.115
upload_flags =
    --port=3232
    --auth=nova2025
    --timeout=60
